CREATE TABLE section (id BIGINT AUTO_INCREMENT, md5 VARCHAR(36) UNIQUE, titre TEXT, titre_complet TEXT, section_id BIGINT, min_date VARCHAR(15), timestamp BIGINT, nb_interventions BIGINT, created_at DATETIME, updated_at DATETIME, INDEX section_id_idx (section_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE presence (id BIGINT AUTO_INCREMENT, parlementaire_id BIGINT, seance_id BIGINT, nb_preuves BIGINT, date DATE, created_at DATETIME, updated_at DATETIME, INDEX parlementaire_id_idx (parlementaire_id), INDEX seance_id_idx (seance_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE parlementaire_organisme (fonction TEXT, importance BIGINT, debut_fonction DATE, organisme_id BIGINT, parlementaire_id BIGINT, PRIMARY KEY(organisme_id, parlementaire_id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE object_commentable (id BIGINT AUTO_INCREMENT, nb_commentaires BIGINT, PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE article_version (id BIGINT, nb_commentaires BIGINT, titre VARCHAR(254), corps TEXT, user_corps TEXT, categorie VARCHAR(128), citoyen_id BIGINT, article_id BIGINT, link VARCHAR(255), status VARCHAR(255) DEFAULT 'brouillon', object_id BIGINT, created_at DATETIME, updated_at DATETIME, version BIGINT, PRIMARY KEY(id, version)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE article (id BIGINT AUTO_INCREMENT, nb_commentaires BIGINT, titre VARCHAR(254), corps TEXT, user_corps TEXT, categorie VARCHAR(128), citoyen_id BIGINT, article_id BIGINT, link VARCHAR(255), status VARCHAR(255) DEFAULT 'brouillon', object_id BIGINT, created_at DATETIME, updated_at DATETIME, version BIGINT, slug VARCHAR(255), INDEX icategories_idx (categorie), INDEX iobject_idx (categorie, object_id), INDEX ititre_idx (categorie, titre), INDEX ititrecitoyen_idx (categorie, titre, citoyen_id), INDEX iarticle_idx (article_id), UNIQUE INDEX sluggable_idx (slug), INDEX citoyen_id_idx (citoyen_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE rate (id BIGINT AUTO_INCREMENT, object_type VARCHAR(50), object_id BIGINT, rate BIGINT, citoyen_id BIGINT, created_at DATETIME, updated_at DATETIME, UNIQUE INDEX unique_idx (object_type, object_id, citoyen_id), INDEX citoyen_id_idx (citoyen_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE commentaire_parlementaires (id BIGINT AUTO_INCREMENT, parlementaire_id BIGINT, commentaire_id BIGINT, UNIQUE INDEX unique_idx (parlementaire_id, commentaire_id), INDEX parlementaire_id_idx (parlementaire_id), INDEX commentaire_id_idx (commentaire_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE organisme (id BIGINT AUTO_INCREMENT, nom VARCHAR(255) UNIQUE, type VARCHAR(255), created_at DATETIME, updated_at DATETIME, slug VARCHAR(255), UNIQUE INDEX sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE parlementaire_amendement (id BIGINT AUTO_INCREMENT, parlementaire_id BIGINT, amendement_id VARCHAR(36), numero_signataire BIGINT, created_at DATETIME, updated_at DATETIME, INDEX parlementaire_id_idx (parlementaire_id), INDEX amendement_id_idx (amendement_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE intervention (id BIGINT AUTO_INCREMENT, nb_commentaires BIGINT, nb_mots BIGINT, md5 VARCHAR(36) UNIQUE, intervention TEXT, timestamp BIGINT, source VARCHAR(128), seance_id BIGINT, section_id BIGINT, type VARCHAR(255), date DATE, personnalite_id BIGINT, parlementaire_id BIGINT, fonction TEXT, created_at DATETIME, updated_at DATETIME, INDEX date_intervention_idx (date), FULLTEXT INDEX ft_intervention_idx (intervention), INDEX section_id_idx (section_id), INDEX seance_id_idx (seance_id), INDEX personnalite_id_idx (personnalite_id), INDEX parlementaire_id_idx (parlementaire_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE object_rated (id BIGINT AUTO_INCREMENT, rate BIGINT, PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE personnalite (id BIGINT AUTO_INCREMENT, nom VARCHAR(255), nom_de_famille VARCHAR(255), sexe VARCHAR(255), created_at DATETIME, updated_at DATETIME, slug VARCHAR(255), UNIQUE INDEX sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE amendement (id BIGINT AUTO_INCREMENT, nb_commentaires BIGINT, source VARCHAR(255) UNIQUE, legislature BIGINT, texteloi_id BIGINT, numero BIGINT, rectif BIGINT, sujet VARCHAR(100), sort VARCHAR(255), date DATE, signataires TEXT, texte TEXT, expose TEXT, content_md5 VARCHAR(36), created_at DATETIME, updated_at DATETIME, FULLTEXT INDEX ft_amendements_idx (sujet, texte, expose), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE variable_globale (id BIGINT AUTO_INCREMENT, champ VARCHAR(32), value LONGBLOB, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE tag (id BIGINT AUTO_INCREMENT, name VARCHAR(100), is_triple TINYINT(1), triple_namespace VARCHAR(100), triple_key VARCHAR(100), triple_value VARCHAR(100), INDEX name_idx (name), INDEX triple1_idx (triple_namespace), INDEX triple2_idx (triple_key), INDEX triple3_idx (triple_value), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE tagging (id BIGINT AUTO_INCREMENT, tag_id BIGINT NOT NULL, taggable_model VARCHAR(30), taggable_id BIGINT, INDEX tag_idx (tag_id), INDEX taggable_idx (taggable_model, taggable_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE commentaire (id BIGINT AUTO_INCREMENT, rate BIGINT, citoyen_id BIGINT, commentaire TEXT, is_public TINYINT(1), ip_address TEXT, object_type VARCHAR(64), object_id BIGINT, lien VARCHAR(128), presentation TEXT, created_at DATETIME, updated_at DATETIME, INDEX commentable_idx (object_type, object_id), INDEX citoyen_id_idx (citoyen_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE question_ecrite (id BIGINT AUTO_INCREMENT, nb_commentaires BIGINT, source VARCHAR(255) UNIQUE, legislature BIGINT, numero BIGINT, date DATE, ministere TEXT, themes TEXT, question TEXT, reponse TEXT, content_md5 VARCHAR(36), parlementaire_id BIGINT, created_at DATETIME, updated_at DATETIME, INDEX parlementaire_id_idx (parlementaire_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE citoyen (id BIGINT AUTO_INCREMENT, login VARCHAR(128) UNIQUE, password VARCHAR(40), email VARCHAR(255) NOT NULL UNIQUE, activite VARCHAR(255), url_site VARCHAR(255), employe_an TINYINT(1) DEFAULT '0', travail_pour BIGINT, naissance DATE, sexe VARCHAR(255), nom_circo VARCHAR(255), num_circo BIGINT, photo LONGBLOB, activation_id VARCHAR(32), is_active TINYINT(1) DEFAULT '0', role VARCHAR(255) DEFAULT 'membre', last_login DATETIME, created_at DATETIME, updated_at DATETIME, slug VARCHAR(255), INDEX is_active_idx (is_active), INDEX role_idx (role), UNIQUE INDEX sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE seance (id BIGINT AUTO_INCREMENT, date DATE, numero_semaine BIGINT, annee BIGINT, type VARCHAR(255), moment VARCHAR(30), organisme_id BIGINT, tagged TINYINT(1), session VARCHAR(10), created_at DATETIME, updated_at DATETIME, UNIQUE INDEX uniq_index_idx (organisme_id, date, moment), INDEX index_session_idx (session), INDEX index_semaine_idx (annee, numero_semaine), INDEX index_annee_idx (annee), INDEX organisme_id_idx (organisme_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE preuve_presence (id BIGINT AUTO_INCREMENT, presence_id BIGINT, type VARCHAR(255), source VARCHAR(200), created_at DATETIME, updated_at DATETIME, INDEX presence_id_idx (presence_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
CREATE TABLE parlementaire (id BIGINT AUTO_INCREMENT, nom VARCHAR(255), nom_de_famille VARCHAR(255), sexe VARCHAR(255), nom_circo VARCHAR(255), num_circo BIGINT, site_web VARCHAR(255), debut_mandat DATE, fin_mandat DATE, place_hemicycle BIGINT, url_an VARCHAR(255), profession VARCHAR(255), photo LONGBLOB, autoflip TINYINT(1), id_an BIGINT, type VARCHAR(255), groupe_acronyme VARCHAR(8), adresses TEXT, autres_mandats TEXT, mails TEXT, top TEXT, created_at DATETIME, updated_at DATETIME, slug VARCHAR(255), UNIQUE INDEX uniq_url_idx (url_an), UNIQUE INDEX sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ENGINE = MyISAM;
ALTER TABLE section ADD FOREIGN KEY (section_id) REFERENCES section(id);
ALTER TABLE presence ADD FOREIGN KEY (seance_id) REFERENCES seance(id);
ALTER TABLE presence ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE parlementaire_organisme ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE parlementaire_organisme ADD FOREIGN KEY (organisme_id) REFERENCES organisme(id);
ALTER TABLE article_version ADD FOREIGN KEY (id) REFERENCES article(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE article ADD FOREIGN KEY (citoyen_id) REFERENCES citoyen(id);
ALTER TABLE article ADD FOREIGN KEY (article_id) REFERENCES article(id);
ALTER TABLE rate ADD FOREIGN KEY (citoyen_id) REFERENCES citoyen(id);
ALTER TABLE commentaire_parlementaires ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE commentaire_parlementaires ADD FOREIGN KEY (commentaire_id) REFERENCES commentaire(id);
ALTER TABLE parlementaire_amendement ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE parlementaire_amendement ADD FOREIGN KEY (amendement_id) REFERENCES amendement(id);
ALTER TABLE intervention ADD FOREIGN KEY (section_id) REFERENCES section(id);
ALTER TABLE intervention ADD FOREIGN KEY (seance_id) REFERENCES seance(id);
ALTER TABLE intervention ADD FOREIGN KEY (personnalite_id) REFERENCES personnalite(id);
ALTER TABLE intervention ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE commentaire ADD FOREIGN KEY (citoyen_id) REFERENCES citoyen(id);
ALTER TABLE question_ecrite ADD FOREIGN KEY (parlementaire_id) REFERENCES parlementaire(id);
ALTER TABLE seance ADD FOREIGN KEY (organisme_id) REFERENCES organisme(id);
ALTER TABLE preuve_presence ADD FOREIGN KEY (presence_id) REFERENCES presence(id);
